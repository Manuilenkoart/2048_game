var e,t,n,r,i,o,a,s,l,u;e={},t={},n=(t={DEFAULT_INITIAL_STATE:Array.from({length:4},function(){return[,,,,].fill(0)}),GAME_STATUS:{idle:"idle",playing:"playing",win:"win",lose:"lose"},MOVE:{up:"up",down:"down",left:"left",right:"right"},showElement:function(e){return document.querySelector(e).classList.remove("hidden")},hideElement:function(e){return document.querySelector(e).classList.add("hidden")},makeDeepClone:function(e){return JSON.parse(JSON.stringify(e))}}).DEFAULT_INITIAL_STATE,r=t.GAME_STATUS,i=t.MOVE,o=t.makeDeepClone,e=/*#__PURE__*/function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.status=r.idle,this.score=0,this.initialState=e,this.board=o(e)}return e=[{key:"start",value:function(){this.status=r.playing,this.addRandomTile(),this.addRandomTile()}},{key:"moveDown",value:function(){this.move(i.down)}},{key:"moveUp",value:function(){this.move(i.up)}},{key:"moveRight",value:function(){this.move(i.right)}},{key:"moveLeft",value:function(){this.move(i.left)}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"restart",value:function(){this.board=o(this.initialState),this.status=r.idle,this.score=0}},{key:"move",value:function(e){var t=this,n=function(n){var r=e===i.up?t.board.map(function(e){return e[n]}):t.board.map(function(e){return e[n]}).reverse();r=e===i.up?t.combineTiles(r):t.combineTiles(r).reverse();for(var o=0;o<4;o++)t.board[o][n]=r[o]},o=JSON.stringify(this.board);if(this.status===r.playing){if([i.up,i.down].includes(e))for(var a=0;a<4;a++)n(a);else if([i.left,i.right].includes(e))for(var s=0;s<4;s++)e===i.left?this.board[s]=this.combineTiles(this.board[s]):this.board[s]=this.combineTiles(this.board[s].reverse()).reverse();o!==JSON.stringify(this.board)&&this.addRandomTile(),this.endGame()}}},{key:"combineTiles",value:function(e){for(var t=e.filter(function(e){return 0!==e}),n=0;n<t.length-1;n++)t[n]===t[n+1]&&(t[n]*=2,this.score+=t[n],t[n+1]=0);return(t=t.filter(function(e){return 0!==e})).concat(Array(4-t.length).fill(0))}},{key:"getEmptyCells",value:function(){for(var e=[],t=0;t<4;t++)for(var n=0;n<4;n++)0===this.board[t][n]&&e.push({row:t,col:n});return e}},{key:"addRandomTile",value:function(){var e=this.getEmptyCells();if(e.length){var t=e[Math.floor(Math.random()*e.length)],n=t.row,r=t.col;this.board[n][r]=.9>Math.random()?2:4}}},{key:"endGame",value:function(){for(var e=!0,t=0;t<4;t++)for(var n=0;n<4;n++)this.board[t][n]>=2048&&(this.status=r.win),(t<3&&this.board[t][n]===this.board[t+1][n]||n<3&&this.board[t][n]===this.board[t][n+1])&&(e=!1);!this.getEmptyCells().length&&e&&(this.status=r.lose)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),a=t.GAME_STATUS,s=t.showElement,l=t.hideElement,u=new e,document.addEventListener("DOMContentLoaded",function(){var e=function(){var e=document.querySelector(".button");u.status===a.idle?(e.classList.remove("restart"),e.classList.add("start"),e.textContent="Start"):(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart")},t=function(){switch(u.status){case a.idle:s(".message-start"),l(".message-win"),l(".message-lose");break;case a.playing:l(".message-start");break;case a.win:s(".message-win");break;case a.lose:s(".message-lose")}e()},n=function(){document.querySelector(".game-score").textContent=u.score},r=function(){for(var e=document.querySelectorAll(".field-cell"),t=0,n=0;n<4;n++)for(var r=0;r<4;r++){var i=e[t];i.textContent=u.board[n][r]||"",i.className="field-cell field-cell--".concat(u.board[n][r]),t++}};document.querySelector(".button").addEventListener("click",function(){u.status===a.idle?u.start():u.restart(),t(),n(),r()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowLeft":u.moveLeft();break;case"ArrowRight":u.moveRight();break;case"ArrowUp":u.moveUp();break;case"ArrowDown":u.moveDown()}t(),n(),r()})});
//# sourceMappingURL=index.78314190.js.map
